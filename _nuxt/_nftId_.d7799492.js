import{_ as q,c as W}from"./index.6f1f47e5.js";import{a as A,b as K,s as j,v as G,r as d,f as x,e as H,h as _,i as t,t as F,u as e,k as S,l as h,m as C,z as L,A as k,B as M,y as J,o as w}from"./entry.66d368a4.js";import{o as Q,B as X,p as Y,r as Z,t as tt}from"./cosmos.04f9d3c0.js";import{q as et}from"./likeco.9ee1a8a5.js";import{u as at}from"./wallet.031c2a45.js";import{u as nt}from"./metadata.d863c358.js";const st=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"NFT information")])],-1),lt=t("td",null,"#0",-1),it=["src"],ot=t("br",null,null,-1),ut=t("br",null,null,-1),rt=["onSubmit"],ct=t("label",{for:"listing-price"},"Price:",-1),dt=t("br",null,null,-1),mt=t("label",{for:"listing-expiration"},"Offer expiration:",-1),vt=["max","min"],pt=t("br",null,null,-1),ft=t("input",{type:"submit",value:"Confirm"},null,-1),gt={key:0},_t=t("br",null,null,-1),ht=t("div",null,"Cancel current listing:",-1),xt=A({__name:"[nftId]",setup(wt){const V=K(),N=j(),T=at(),B=nt(),{wallet:l,signer:i}=G(T),E=d({}),m=d({}),o=d(32),v=d(new Date(Date.now()+15552e6).toISOString().split("T")[0]),p=d(!1),R=new Date(Date.now()+15552e6).toISOString().split("T")[0],O=new Date(Date.now()).toISOString().split("T")[0],a=x(()=>N.params.classId),r=x(()=>N.params.nftId),{connect:b}=T,{lazyFetchClassMetadata:$,lazyFetchNFTMetadata:z}=B;H(async()=>{const[s,n,u,f]=await Promise.all([$(a.value),z(a.value,r.value),Q({classId:a.value,nftId:r.value}),et(a.value)]);E.value=s,m.value=n,u.length?(p.value=!0,o.value=new X(u[0].price).shiftedBy(-9).toNumber()):o.value=f.price});async function g(s){V.push({path:`/listings/${s}`})}async function P(){if((!l.value||!i.value)&&await b(),!l.value||!i.value)return;const s=new Date(v.value).getTime(),u=await(p.value?Z(a.value,r.value,o.value,s,i.value,l.value):tt(a.value,r.value,o.value,s,i.value,l.value));console.log(u),g(a.value)}async function U(){if((!l.value||!i.value)&&await b(),!l.value||!i.value)return;const s=await Y(a.value,r.value,i.value,l.value);console.log(s),g(a.value)}return(s,n)=>{var f,y,D,I;const u=q;return w(),_("div",null,[t("h1",null,F(e(p)?"Edit NFT listing":"List NFT for sell"),1),t("table",null,[st,t("tbody",null,[t("tr",null,[lt,t("td",null,[t("div",null,[t("h4",null,F((f=e(m).data)==null?void 0:f.metadata.name),1),(D=(y=e(m).data)==null?void 0:y.metadata)!=null&&D.image?(w(),_("img",{key:0,src:e(W)((I=e(m).data)==null?void 0:I.metadata.image),width:"256",height:"256"},null,8,it)):S("",!0),ot,h(" Class ID: "),C(u,{"class-id":e(a)},null,8,["class-id"]),ut,h(" NFT ID: "),C(u,{"class-id":e(a),"nft-id":e(r)},null,8,["class-id","nft-id"])]),t("button",{onClick:n[0]||(n[0]=c=>g(e(a)))},"View current listing for class")])])])]),t("form",{onSubmit:J(P,["prevent"])},[ct,L(t("input",{type:"number",id:"listing-price","onUpdate:modelValue":n[1]||(n[1]=c=>M(o)?o.value=c:null)},null,512),[[k,e(o)]]),h(" LIKE "),dt,mt,L(t("input",{type:"date",id:"listing-expiration","onUpdate:modelValue":n[2]||(n[2]=c=>M(v)?v.value=c:null),max:e(R),min:e(O)},null,8,vt),[[k,e(v)]]),pt,ft],40,rt),e(p)?(w(),_("div",gt,[_t,ht,t("button",{onClick:n[3]||(n[3]=c=>U())},"Cancel")])):S("",!0)])}}});export{xt as default};
