import{_ as j,c as q}from"./index.bc15b548.js";import{f as W,g as K,m as A,s as G,r as d,i as D,h as H,o as _,c as h,a as t,t as F,j as e,l as x,d as w,b as C,x as L,y as k,z as M,v as J}from"./entry.7beecde4.js";import{j as Q,B as X,k as Y,l as Z,m as tt}from"./cosmos.d773931a.js";import{q as et}from"./likeco.bc7436bb.js";import{u as at}from"./wallet.7723eab4.js";import{u as nt}from"./metadata.90d43393.js";const st=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"NFT information")])],-1),lt=t("td",null,"#0",-1),it=["src"],ot=t("br",null,null,-1),ut=t("br",null,null,-1),rt=["onSubmit"],ct=t("label",{for:"listing-price"},"Price:",-1),dt=t("br",null,null,-1),mt=t("label",{for:"listing-expiration"},"Offer expiration:",-1),vt=["max","min"],pt=t("br",null,null,-1),ft=t("input",{type:"submit",value:"Confirm"},null,-1),gt={key:0},_t=t("br",null,null,-1),ht=t("div",null,"Cancel current listing:",-1),Dt=W({__name:"[nftId]",setup(wt){const V=K(),N=A(),T=at(),E=nt(),{wallet:l,signer:i}=G(T),R=d({}),m=d({}),o=d(32),v=d(new Date(Date.now()+15552e6).toISOString().split("T")[0]),p=d(!1),B=new Date(Date.now()+15552e6).toISOString().split("T")[0],O=new Date(Date.now()).toISOString().split("T")[0],a=D(()=>N.params.classId),r=D(()=>N.params.nftId),{connect:b}=T,{lazyFetchClassMetadata:$,lazyFetchNFTMetadata:z}=E;H(async()=>{const[n,s,u,f]=await Promise.all([$(a.value),z(a.value,r.value),Q({classId:a.value,nftId:r.value}),et(a.value)]);R.value=n,m.value=s,u.length?(p.value=!0,o.value=new X(u[0].price).shiftedBy(-9).toNumber()):o.value=f.price});async function g(n){V.push({path:`/listings/${n}`})}async function P(){if((!l.value||!i.value)&&await b(),!l.value||!i.value)return;const n=new Date(v.value).getTime(),u=await(p.value?Z(a.value,r.value,o.value,n,i.value,l.value):tt(a.value,r.value,o.value,n,i.value,l.value));console.log(u),g(a.value)}async function U(){if((!l.value||!i.value)&&await b(),!l.value||!i.value)return;const n=await Y(a.value,r.value,i.value,l.value);console.log(n),g(a.value)}return(n,s)=>{var f,I,y,S;const u=j;return _(),h("div",null,[t("h1",null,F(e(p)?"Edit NFT listing":"List NFT for sell"),1),t("table",null,[st,t("tbody",null,[t("tr",null,[lt,t("td",null,[t("div",null,[t("h4",null,F((f=e(m).data)==null?void 0:f.metadata.name),1),(y=(I=e(m).data)==null?void 0:I.metadata)!=null&&y.image?(_(),h("img",{key:0,src:("convertImageSrc"in n?n.convertImageSrc:e(q))((S=e(m).data)==null?void 0:S.metadata.image),width:"256",height:"256"},null,8,it)):x("",!0),ot,w(" Class ID: "),C(u,{"class-id":e(a)},null,8,["class-id"]),ut,w(" NFT ID: "),C(u,{"class-id":e(a),"nft-id":e(r)},null,8,["class-id","nft-id"])]),t("button",{onClick:s[0]||(s[0]=c=>g(e(a)))},"View current listing for class")])])])]),t("form",{onSubmit:J(P,["prevent"])},[ct,L(t("input",{type:"number",id:"listing-price","onUpdate:modelValue":s[1]||(s[1]=c=>M(o)?o.value=c:null)},null,512),[[k,e(o)]]),w(" LIKE "),dt,mt,L(t("input",{type:"date",id:"listing-expiration","onUpdate:modelValue":s[2]||(s[2]=c=>M(v)?v.value=c:null),max:e(B),min:e(O)},null,8,vt),[[k,e(v)]]),pt,ft],40,rt),e(p)?(_(),h("div",gt,[_t,ht,t("button",{onClick:s[3]||(s[3]=c=>U())},"Cancel")])):x("",!0)])}}});export{Dt as default};
