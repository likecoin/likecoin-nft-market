import{d as E,e as q,f as M,h as P,_ as R,c as K,i as O,B as j,s as z}from"./index.65c0c028.js";import{_ as A}from"./UserLink.vue_vue_type_script_setup_true_lang.4be7e6e2.js";import{a as J,b as U,s as G,v as H,r as v,f as x,e as Q,h as l,i as t,t as m,u as e,k,l as p,m as w,F as X,j as Y,o as n,c as Z,w as tt}from"./entry.3c853183.js";import{u as et}from"./wallet.01f0302e.js";import{u as st}from"./metadata.b1948a8a.js";async function at(b){var f;try{return(await E.get(`${q}/likernft/purchase?class_id=${b}`)).data}catch(u){return((f=u.response)==null?void 0:f.status)!==404&&console.error(JSON.stringify(u)),null}}const nt=t("br",null,null,-1),lt=["src"],ot=t("br",null,null,-1),rt=["href"],it=t("br",null,null,-1),ct=t("h2",null,"Listings",-1),ut={key:0},dt={key:1},_t=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"NFT information"),t("th",null,"Listing Price")])],-1),mt=t("br",null,null,-1),ft={key:0},ht=["onClick"],wt=J({__name:"[classId]",setup(b){const f=U(),u=G(),I=et(),B=st(),{wallet:g,signer:y}=H(I),N=v([]),F=v([]),o=v({}),d=x(()=>u.params.classId),C=x(()=>[].concat(...N.value,...F.value).sort((s,r)=>s.price.toNumber()-r.price.toNumber())),{connect:S}=I,{lazyFetchClassMetadata:$}=B;Q(async()=>{await Promise.all([$(d.value).then(s=>o.value=s),M(d.value).then(s=>N.value=s),await W(d.value)])});async function W(s){const r=await at(s);if(r){const{price:i,metadata:{nextNewNFTId:_,ownerWallet:c}}=r;F.value=[{classId:s,nftId:_,price:P.fromNumber(i*1e9),seller:c,isWritingNFT:!0}]}}async function V({classId:s,nftId:r,seller:i,price:_}){if((!g.value||!y.value)&&await S(),!g.value||!y.value)return;const c=new j(_).shiftedBy(-9).toNumber(),h=await z(s,r,i,c,y.value,g.value);console.log(h),f.push({path:"/owned"})}return(s,r)=>{var c,h,T,L;const i=R,_=A;return n(),l("div",null,[t("h1",null,m(e(o).name),1),nt,(h=(c=e(o).data)==null?void 0:c.metadata)!=null&&h.image?(n(),l("img",{key:0,src:e(K)(e(o).data.metadata.image),width:"256",height:"256"},null,8,lt)):k("",!0),ot,t("p",null,m(e(o).description),1),t("div",null,[p("Class ID: "),w(i,{"class-id":e(d)},null,8,["class-id"])]),(L=(T=e(o).data)==null?void 0:T.metadata)!=null&&L.external_url?(n(),l("a",{key:1,href:e(o).data.metadata.external_url,target:"_blank",rel:"noopener"},"View External Link",8,rt)):k("",!0),it,ct,t("section",null,[e(N).length?(n(),l("table",dt,[_t,t("tbody",null,[(n(!0),l(X,null,Y(e(C),(a,D)=>(n(),l("tr",{key:`${a.classId}_${a.nftId}`},[t("td",null,"#"+m(D+1),1),t("td",null,[t("div",null,[p(" NFT ID: "),w(i,{"class-id":a.classId,"nft-id":a.nftId},null,8,["class-id","nft-id"]),mt,p(" Sold by: "),w(_,{wallet:a.seller},null,8,["wallet"])])]),t("td",null,[t("section",null,[t("div",null,m(e(O)(a.price))+" LIKE",1),a.expiration?(n(),l("div",ft,"till "+m(a.expiration),1)):k("",!0)]),a.isWritingNFT?(n(),Z(i,{key:0,"class-id":e(d)},{default:tt(()=>[p("Buy from liker.land")]),_:1},8,["class-id"])):(n(),l("button",{key:1,onClick:pt=>V(a)},"Buy",8,ht))])]))),128))])])):(n(),l("div",ut,"No one is selling this NFT yet"))])])}}});export{wt as default};
