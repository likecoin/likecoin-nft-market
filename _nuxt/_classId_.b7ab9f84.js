import{_ as E,c as q,a as M}from"./index.b1ce2bb9.js";import{_ as P}from"./UserLink.vue_vue_type_script_setup_true_lang.a550faa6.js";import{a as R,b as K,s as O,v as j,r as N,f as B,e as z,h as l,i as t,t as m,u as e,k as v,l as p,m as k,F as A,j as J,o as n,c as U,w as G}from"./entry.136745c4.js";import{c as H,d as Q,e as X,f as Y,B as Z,s as tt}from"./cosmos.50c2661b.js";import{u as et}from"./wallet.6e563ee6.js";import{u as st}from"./metadata.f4defd06.js";async function at(w){var f;try{return(await H.get(`${Q}/likernft/purchase?class_id=${w}`)).data}catch(u){return((f=u.response)==null?void 0:f.status)!==404&&console.error(JSON.stringify(u)),null}}const nt=t("br",null,null,-1),lt=["src"],ot=t("br",null,null,-1),rt=["href"],it=t("br",null,null,-1),ct=t("h2",null,"Listings",-1),ut={key:0},dt={key:1},_t=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"NFT information"),t("th",null,"Listing Price")])],-1),mt=t("br",null,null,-1),ft={key:0},ht=["onClick"],bt=R({__name:"[classId]",setup(w){const f=K(),u=O(),b=et(),C=st(),{wallet:g,signer:y}=j(b),I=N([]),F=N([]),o=N({}),d=B(()=>u.params.classId),T=B(()=>[].concat(...I.value,...F.value).sort((s,r)=>s.price.toNumber()-r.price.toNumber())),{connect:S}=b,{lazyFetchClassMetadata:$}=C;z(async()=>{await Promise.all([$(d.value).then(s=>o.value=s),X(d.value).then(s=>I.value=s),await W(d.value)])});async function W(s){const r=await at(s);if(r){const{price:i,metadata:{nextNewNFTId:_,ownerWallet:c}}=r;F.value=[{classId:s,nftId:_,price:Y.fromNumber(i*1e9),seller:c,isWritingNFT:!0}]}}async function V({classId:s,nftId:r,seller:i,price:_}){if((!g.value||!y.value)&&await S(),!g.value||!y.value)return;const c=new Z(_).shiftedBy(-9).toNumber(),h=await tt(s,r,i,c,y.value,g.value);console.log(h),f.push({path:"/owned"})}return(s,r)=>{var c,h,L,x;const i=E,_=P;return n(),l("div",null,[t("h1",null,m(e(o).name),1),nt,(h=(c=e(o).data)==null?void 0:c.metadata)!=null&&h.image?(n(),l("img",{key:0,src:e(q)(e(o).data.metadata.image),width:"256",height:"256"},null,8,lt)):v("",!0),ot,t("p",null,m(e(o).description),1),t("div",null,[p("Class ID: "),k(i,{"class-id":e(d)},null,8,["class-id"])]),(x=(L=e(o).data)==null?void 0:L.metadata)!=null&&x.external_url?(n(),l("a",{key:1,href:e(o).data.metadata.external_url,target:"_blank",rel:"noopener"},"View External Link",8,rt)):v("",!0),it,ct,t("section",null,[e(T).length?(n(),l("table",dt,[_t,t("tbody",null,[(n(!0),l(A,null,J(e(T),(a,D)=>(n(),l("tr",{key:`${a.classId}_${a.nftId}`},[t("td",null,"#"+m(D+1),1),t("td",null,[t("div",null,[p(" NFT ID: "),k(i,{"class-id":a.classId,"nft-id":a.nftId},null,8,["class-id","nft-id"]),mt,p(" Sold by: "),k(_,{wallet:a.seller},null,8,["wallet"])])]),t("td",null,[t("section",null,[t("div",null,m(e(M)(a.price))+" LIKE",1),a.expiration?(n(),l("div",ft,"till "+m(a.expiration),1)):v("",!0)]),a.isWritingNFT?(n(),U(i,{key:0,"class-id":e(d)},{default:G(()=>[p("Buy from liker.land")]),_:1},8,["class-id"])):(n(),l("button",{key:1,onClick:pt=>V(a)},"Buy",8,ht))])]))),128))])])):(n(),l("div",ut,"No one is selling this NFT yet"))])])}}});export{bt as default};
