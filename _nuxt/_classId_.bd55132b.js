import{d as E,e as q,f as M,h as P,_ as R,c as K,i as O,B as j,s as z}from"./index.6880536b.js";import{_ as A}from"./UserLink.vue_vue_type_script_setup_true_lang.5eb063b4.js";import{a as J,b as U,s as G,v as H,r as N,f as x,e as Q,h as n,i as t,t as f,u as e,k,l as g,m as w,F as X,j as Y,o as a,c as Z,w as tt}from"./entry.9dbada17.js";import{u as et}from"./wallet.7ac4a37e.js";import{u as st}from"./metadata.be20e5ac.js";async function at(I){var m;try{return(await E.get(`${q}/likernft/purchase?class_id=${I}`)).data}catch(i){return((m=i.response)==null?void 0:m.status)!==404&&console.error(JSON.stringify(i)),null}}const nt=t("br",null,null,-1),lt=["src"],ot=t("br",null,null,-1),rt=["href"],it=t("br",null,null,-1),ct=t("h2",null,"Listings",-1),ut={key:0},dt={key:1},_t=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"NFT information"),t("th",null,"Listing Price")])],-1),ft=t("br",null,null,-1),mt={key:0},ht=["onClick"],wt=J({__name:"[classId]",setup(I){const m=U(),i=G(),b=et(),B=st(),{wallet:p,signer:y}=H(b),v=N([]),F=N([]),l=N({}),c=x(()=>i.params.classId),C=x(()=>[].concat(...v.value,...F.value)),{connect:S}=b,{lazyFetchClassMetadata:$}=B;Q(async()=>{[l.value,v.value]=await Promise.all([$(c.value),M(c.value),await W(c.value)])});async function W(u){const d=await at(u);if(d){const{price:o,metadata:{nextNewNFTId:_,ownerWallet:r}}=d;F.value=[{classId:u,nftId:_,price:P.fromNumber(o*1e9),seller:r,isWritingNFT:!0}]}}async function V({classId:u,nftId:d,seller:o,price:_}){if((!p.value||!y.value)&&await S(),!p.value||!y.value)return;const r=new j(_).shiftedBy(-9).toNumber(),h=await z(u,d,o,r,y.value,p.value);console.log(h),m.push({path:"/owned"})}return(u,d)=>{var r,h,T,L;const o=R,_=A;return a(),n("div",null,[t("h1",null,f(e(l).name),1),nt,(h=(r=e(l).data)==null?void 0:r.metadata)!=null&&h.image?(a(),n("img",{key:0,src:e(K)(e(l).data.metadata.image),width:"256",height:"256"},null,8,lt)):k("",!0),ot,t("p",null,f(e(l).description),1),t("div",null,[g("Class ID: "),w(o,{"class-id":e(c)},null,8,["class-id"])]),(L=(T=e(l).data)==null?void 0:T.metadata)!=null&&L.external_url?(a(),n("a",{key:1,href:e(l).data.metadata.external_url,target:"_blank",rel:"noopener"},"View External Link",8,rt)):k("",!0),it,ct,t("section",null,[e(v).length?(a(),n("table",dt,[_t,t("tbody",null,[(a(!0),n(X,null,Y(e(C),(s,D)=>(a(),n("tr",{key:`${s.classId}_${s.nftId}`},[t("td",null,"#"+f(D+1),1),t("td",null,[t("div",null,[g(" NFT ID: "),w(o,{"class-id":s.classId,"nft-id":s.nftId},null,8,["class-id","nft-id"]),ft,g(" Sold by: "),w(_,{wallet:s.seller},null,8,["wallet"])])]),t("td",null,[t("section",null,[t("div",null,f(e(O)(s.price))+" LIKE",1),s.expiration?(a(),n("div",mt,"till "+f(s.expiration),1)):k("",!0)]),s.isWritingNFT?(a(),Z(o,{key:0,"class-id":e(c)},{default:tt(()=>[g("Buy from liker.land")]),_:1},8,["class-id"])):(a(),n("button",{key:1,onClick:gt=>V(s)},"Buy",8,ht))])]))),128))])])):(a(),n("div",ut,"No one is selling this NFT yet"))])])}}});export{wt as default};
